# ë°±ì—”ë“œ API ì—°ë™ êµ¬í˜„

## ğŸ“… ì‘ì—… ì¼ì‹œ
**2024ë…„ 12ì›” 18ì¼**

## ğŸ¯ ì—°ë™ ëª©í‘œ
í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ê°„ì˜ ì™„ì „í•œ ë°ì´í„° ë™ê¸°í™” ë° ì‹¤ì‹œê°„ ìƒíƒœ ê´€ë¦¬ êµ¬í˜„

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ê°œìš”

### ë°°í¬ í™˜ê²½
- **í”„ë¡ íŠ¸ì—”ë“œ**: GitHub Pages (https://aebonlee.github.io/AHP_forPaper/)
- **ë°±ì—”ë“œ**: Render.com (https://ahp-forpaper.onrender.com)
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL on Render.com

### API ê¸°ë³¸ êµ¬ì¡°
```typescript
// API ë² ì´ìŠ¤ URL ì„¤ì •
export const API_BASE_URL = process.env.NODE_ENV === 'development' 
  ? 'http://localhost:5000' 
  : 'https://ahp-forpaper.onrender.com';
```

## ğŸ“¡ êµ¬í˜„ëœ API ì—”ë“œí¬ì¸íŠ¸

### 1. í”„ë¡œì íŠ¸ ê´€ë¦¬ API

#### GET /api/projects
**ëª©ì **: ì‚¬ìš©ìì˜ í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ
**ì¸ì¦**: Bearer Token í•„ìš”

```typescript
const loadProjects = async () => {
  const response = await fetch(`${API_BASE_URL}/api/projects`, {
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    }
  });
  
  if (response.ok) {
    const data = await response.json();
    return data.projects;
  }
};
```

**ì‘ë‹µ í˜•ì‹**:
```json
{
  "projects": [
    {
      "id": 1,
      "title": "AI ë„êµ¬ ì„ íƒ ë¶„ì„",
      "description": "ê°œë°œíŒ€ì˜ AI ë„êµ¬ ì„ íƒì„ ìœ„í•œ AHP ë¶„ì„",
      "status": "active",
      "evaluation_mode": "practical",
      "workflow_stage": "evaluating",
      "created_at": "2024-12-18T00:00:00Z",
      "evaluator_count": 5,
      "admin_name": "í™ê¸¸ë™"
    }
  ]
}
```

#### POST /api/projects
**ëª©ì **: ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
**ì¸ì¦**: Bearer Token í•„ìš”

```typescript
const createProject = async (projectData) => {
  const response = await fetch(`${API_BASE_URL}/api/projects`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      title: projectData.title,
      description: projectData.description,
      objective: projectData.objective,
      evaluationMode: projectData.evaluation_mode
    })
  });
};
```

#### PUT /api/projects/:id
**ëª©ì **: í”„ë¡œì íŠ¸ ì •ë³´ ìˆ˜ì •

#### DELETE /api/projects/:id
**ëª©ì **: í”„ë¡œì íŠ¸ ì‚­ì œ

### 2. í‰ê°€ì ê´€ë¦¬ API

#### GET /api/evaluators
**ëª©ì **: í‰ê°€ì ëª©ë¡ ì¡°íšŒ

#### POST /api/evaluators
**ëª©ì **: ìƒˆ í‰ê°€ì ì¶”ê°€

#### POST /api/evaluators/invite
**ëª©ì **: í‰ê°€ì ì´ˆëŒ€ ì´ë©”ì¼ ë°œì†¡

```typescript
const sendInvitation = async (evaluatorId, projectId, emailContent, shortLink) => {
  const response = await fetch(`${API_BASE_URL}/api/evaluators/invite`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      evaluatorId,
      projectId,
      emailContent,
      shortLink
    })
  });
};
```

## ğŸ” ì¸ì¦ ì‹œìŠ¤í…œ

### JWT í† í° ê¸°ë°˜ ì¸ì¦
```typescript
// í† í° ì €ì¥
localStorage.setItem('token', authToken);

// í† í° ì‚¬ìš©
const token = localStorage.getItem('token');
if (!token) {
  // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
  return;
}
```

### í† í° ê²€ì¦
ëª¨ë“  API ìš”ì²­ì—ì„œ í† í° ìœ íš¨ì„± ê²€ì‚¬
```typescript
if (!token) {
  setError('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
  return;
}
```

## ğŸ“Š ë°ì´í„° ë™ê¸°í™” ì „ëµ

### 1. ì‹¤ì‹œê°„ ë™ê¸°í™”
ë©”ë‰´ ë³€ê²½ ì‹œ ìë™ ë°ì´í„° ë¦¬ë¡œë“œ
```typescript
useEffect(() => {
  if (activeMenu === 'projects' || activeMenu === 'dashboard') {
    loadProjects();
  }
}, [activeMenu]);
```

### 2. ì´ì¤‘ ë°±ì—… ì‹œìŠ¤í…œ
#### ì£¼ ì €ì¥ì†Œ: PostgreSQL
```sql
-- í”„ë¡œì íŠ¸ í…Œì´ë¸” êµ¬ì¡°
CREATE TABLE projects (
  id SERIAL PRIMARY KEY,
  title VARCHAR(255) NOT NULL,
  description TEXT,
  objective TEXT,
  admin_id INTEGER NOT NULL REFERENCES users(id),
  status VARCHAR(20) DEFAULT 'draft',
  evaluation_mode VARCHAR(20) DEFAULT 'practical',
  workflow_stage VARCHAR(20) DEFAULT 'creating',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);
```

#### ë³´ì¡° ì €ì¥ì†Œ: localStorage
```typescript
// ë°±ì—… ì €ì¥
localStorage.setItem('ahp_projects_backup', JSON.stringify(projects));

// ë³µêµ¬ ì‹œ ì‚¬ìš©
const backupData = localStorage.getItem('ahp_projects_backup');
if (backupData) {
  const backupProjects = JSON.parse(backupData);
  setProjects(backupProjects);
}
```

## ğŸ›¡ï¸ ì˜¤ë¥˜ ì²˜ë¦¬

### ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²˜ë¦¬
```typescript
try {
  const response = await fetch(url, options);
  if (!response.ok) {
    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
  }
  return await response.json();
} catch (error) {
  console.error('API Error:', error);
  // ë°±ì—… ë°ì´í„° ì‚¬ìš©
  return loadFromBackup();
}
```

### HTTP ìƒíƒœ ì½”ë“œ ì²˜ë¦¬
- **200**: ì„±ê³µ
- **201**: ìƒì„± ì„±ê³µ
- **400**: ì˜ëª»ëœ ìš”ì²­
- **401**: ì¸ì¦ ì‹¤íŒ¨
- **403**: ê¶Œí•œ ì—†ìŒ
- **404**: ë¦¬ì†ŒìŠ¤ ì—†ìŒ
- **500**: ì„œë²„ ì˜¤ë¥˜

## ğŸ”„ ìƒíƒœ ê´€ë¦¬ íŒ¨í„´

### Loading ìƒíƒœ
```typescript
const [loading, setLoading] = useState(false);

const apiCall = async () => {
  setLoading(true);
  try {
    const result = await fetch(url);
    // ì²˜ë¦¬
  } finally {
    setLoading(false);
  }
};
```

### Error ìƒíƒœ
```typescript
const [error, setError] = useState(null);

// ì˜¤ë¥˜ ë°œìƒ ì‹œ
setError('ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');

// ì„±ê³µ ì‹œ ì˜¤ë¥˜ ì´ˆê¸°í™”
setError(null);
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### 1. ë°ì´í„° ìºì‹±
localStorageë¥¼ í™œìš©í•œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ìºì‹±
```typescript
// ìºì‹œ í™•ì¸ í›„ API í˜¸ì¶œ
const cachedData = localStorage.getItem('projects_cache');
const cacheTime = localStorage.getItem('projects_cache_time');

if (cachedData && cacheTime) {
  const age = Date.now() - parseInt(cacheTime);
  if (age < 5 * 60 * 1000) { // 5ë¶„ ìºì‹œ
    return JSON.parse(cachedData);
  }
}
```

### 2. ìš”ì²­ ìµœì í™”
ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ë°©ì§€
```typescript
// ë””ë°”ìš´ì‹±ìœ¼ë¡œ ê²€ìƒ‰ ìš”ì²­ ìµœì í™”
const [searchTerm, setSearchTerm] = useState('');
const debouncedSearch = useDebounce(searchTerm, 500);

useEffect(() => {
  if (debouncedSearch) {
    searchProjects(debouncedSearch);
  }
}, [debouncedSearch]);
```

## ğŸ§ª API í…ŒìŠ¤íŠ¸

### ê°œë°œ í™˜ê²½ í…ŒìŠ¤íŠ¸
```bash
# ë¡œì»¬ ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰
cd backend
npm run dev

# í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì„œë²„ ì‹¤í–‰  
cd frontend
npm start
```

### í”„ë¡œë•ì…˜ í™˜ê²½ í…ŒìŠ¤íŠ¸
- Render.com ë°°í¬ ìƒíƒœ í™•ì¸
- PostgreSQL ì—°ê²° ìƒíƒœ í™•ì¸
- API ì‘ë‹µ ì‹œê°„ ëª¨ë‹ˆí„°ë§

## ğŸ“‹ API ë¬¸ì„œí™”

### Swagger/OpenAPI
ë°±ì—”ë“œì—ì„œ ìë™ ìƒì„±ëœ API ë¬¸ì„œ ì œê³µ ì˜ˆì •

### ìš”ì²­/ì‘ë‹µ ì˜ˆì‹œ
ê° ì—”ë“œí¬ì¸íŠ¸ë³„ ìƒì„¸í•œ ìš”ì²­/ì‘ë‹µ ì˜ˆì‹œ ë¬¸ì„œí™”

## ğŸ”® í–¥í›„ ê°œì„  ê³„íš

### ë‹¨ê¸° ê³„íš
- GraphQL ë„ì… ê²€í† 
- ì‹¤ì‹œê°„ WebSocket ì—°ê²°
- API ì‘ë‹µ ì‹œê°„ ìµœì í™”

### ì¤‘ê¸° ê³„íš  
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ ì „í™˜
- Redis ìºì‹± ë ˆì´ì–´ ì¶”ê°€
- API ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œ

### ì¥ê¸° ê³„íš
- ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ ê²€í† 
- CDN í™œìš© ìµœì í™”
- ê¸€ë¡œë²Œ ë°°í¬ ì „ëµ

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë¡œê¹…
```typescript
console.log('Projects loaded successfully:', projects.length);
console.error('API Error:', error);
```

### ì„œë²„ ì‚¬ì´ë“œ ëª¨ë‹ˆí„°ë§
- Render.com ë‚´ì¥ ëª¨ë‹ˆí„°ë§
- PostgreSQL ì„±ëŠ¥ ì¶”ì 
- API ì‘ë‹µ ì‹œê°„ ì¸¡ì •

---

**ì™„ë£Œ ì¼ì‹œ**: 2024ë…„ 12ì›” 18ì¼  
**ë‹´ë‹¹ì**: Claude Code (AI Assistant)  
**ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ í™˜ê²½ ë°°í¬ ì™„ë£Œ