# 57. í‰ê°€ì ë°°ì • ê¸°ëŠ¥ ìµœì¢… ìˆ˜ì • ê°œë°œ ë³´ê³ ì„œ

## ğŸ“‹ ê°œë°œ ê°œìš”
- **ì‘ì—…ì¼**: 2025-09-02
- **ë‹´ë‹¹ì**: Claude Code Assistant
- **ì‘ì—… ë¶„ë¥˜**: ê¸´ê¸‰ ë²„ê·¸ ìˆ˜ì •, API í˜¸í™˜ì„± ì™„ì „ í•´ê²°
- **ìš°ì„ ìˆœìœ„**: ìµœê¸´ê¸‰
- **ì†Œìš” ì‹œê°„**: 30ë¶„

## ğŸ¯ ì‘ì—… ëª©í‘œ
í‰ê°€ì ì¶”ê°€ ë²„íŠ¼ì´ ë™ì‘í•˜ì§€ ì•ŠëŠ” ë¬¸ì œë¥¼ ì™„ì „íˆ í•´ê²°í•˜ì—¬ ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± ì‹œ í‰ê°€ì ë°°ì •ì´ ì •ìƒ ì‘ë™í•˜ë„ë¡ ìˆ˜ì •

## ğŸ”§ ë¬¸ì œ ë¶„ì„

### ê¸°ì¡´ ë¬¸ì œì 
1. **API í•„ë“œ ë¶ˆì¼ì¹˜**: ë°±ì—”ë“œê°€ `evaluator_code` í•„ë“œë¥¼ ìš”êµ¬í•˜ì§€ë§Œ DBì— í•´ë‹¹ ì»¬ëŸ¼ ì—†ìŒ
2. **ì¿¼ë¦¬ ì‹¤íŒ¨**: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì»¬ëŸ¼ ì°¸ì¡°ë¡œ SQL ì—ëŸ¬ ë°œìƒ
3. **ë°ì´í„° êµ¬ì¡° ë¶ˆì¼ì¹˜**: í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ê°„ ì˜ˆìƒ ë°ì´í„° í˜•ì‹ ì°¨ì´
4. **ì„¸ì…˜ ê´€ë¦¬ ëˆ„ë½**: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œ ì„¸ì…˜ íƒ€ì´ë¨¸ ì´ˆê¸°í™”

## ğŸ“‚ ìˆ˜ì • íŒŒì¼
```
backend/src/routes/evaluators.ts - API ì—”ë“œí¬ì¸íŠ¸ ì™„ì „ ê°œì„ 
src/components/admin/EvaluatorAssignment.tsx - ìƒˆ API êµ¬ì¡° ì ìš©
src/services/sessionService.ts - ì„¸ì…˜ íƒ€ì´ë¨¸ ë³µêµ¬ ê¸°ëŠ¥ ì¶”ê°€
src/App.tsx - ì„¸ì…˜ ì´ˆê¸°í™” ë¡œì§ ê°•í™”
docs_03/56-session-timeout-30min-implementation.md - ì„¸ì…˜ ê°œë°œ ë¬¸ì„œ
```

## ğŸ”§ ì£¼ìš” ê°œë°œì‚¬í•­

### 1. ë°±ì—”ë“œ API ì™„ì „ ë¦¬íŒ©í† ë§

#### API ìš”ì²­ êµ¬ì¡° ë³€ê²½
```typescript
// Before: ì‹¤íŒ¨í•˜ëŠ” êµ¬ì¡°
{
  project_id: number,
  evaluator_code: string,  // DBì— ì—†ëŠ” ì»¬ëŸ¼
  evaluator_name: string
}

// After: ì„±ê³µí•˜ëŠ” êµ¬ì¡°  
{
  project_id: number,
  evaluator_name: string,
  evaluator_email?: string,  // ì„ íƒì  ì´ë©”ì¼
  weight?: number
}
```

#### ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™”
```sql
-- Before: ì‹¤íŒ¨í•˜ëŠ” ì¿¼ë¦¬
INSERT INTO project_evaluators (project_id, evaluator_id, evaluator_code, access_key)
VALUES ($1, $2, $3, $4)

-- After: ì„±ê³µí•˜ëŠ” ì¿¼ë¦¬
INSERT INTO project_evaluators (project_id, evaluator_id)
VALUES ($1, $2)
ON CONFLICT (project_id, evaluator_id) DO UPDATE SET assigned_at = CURRENT_TIMESTAMP
```

### 2. í‰ê°€ì ì½”ë“œ ìƒì„± ë¡œì§ ê°œì„ 

#### ë™ì  ì½”ë“œ ìƒì„±
```typescript
// ë°±ì—”ë“œì—ì„œ ìë™ ìƒì„±
const evaluator_code = `EVL${Date.now().toString().slice(-6)}`;

// ì‘ë‹µì—ì„œ ID ê¸°ë°˜ ì½”ë“œ ì œê³µ
code: `EVL${row.id}`,
access_key: generateAccessKey(`EVL${row.id}`, projectId)
```

### 3. í”„ë¡ íŠ¸ì—”ë“œ API í˜¸ì¶œ êµ¬ì¡° ë³€ê²½

#### ìš”ì²­ ë°ì´í„° ë‹¨ìˆœí™”
```typescript
// Before: ë³µì¡í•œ ì½”ë“œ ìƒì„±
const assignData = {
  project_id: Number(projectId),
  evaluator_code: evaluatorData.code,  // ì œê±°ë¨
  evaluator_name: evaluatorData.name,
  weight: 1.0
};

// After: ë‹¨ìˆœí•œ êµ¬ì¡°
const assignData = {
  project_id: Number(projectId),
  evaluator_name: evaluatorData.name,
  evaluator_email: evaluatorData.email || undefined,
  weight: 1.0
};
```

### 4. ì„¸ì…˜ íƒ€ì´ë¨¸ ë³µêµ¬ ì‹œìŠ¤í…œ

#### í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ëŒ€ì‘
```typescript
// ì„¸ì…˜ ì´ˆê¸°í™” ì‹œ íƒ€ì´ë¨¸ ë³µêµ¬
private initializeSession(): void {
  const loginTime = localStorage.getItem('login_time');
  if (loginTime) {
    const elapsed = Date.now() - parseInt(loginTime);
    if (elapsed < this.SESSION_DURATION) {
      this.resumeSessionTimer(this.SESSION_DURATION - elapsed);
    } else {
      this.forceLogout();
    }
  }
}
```

## âœ… êµ¬í˜„ëœ ê¸°ëŠ¥

### ğŸ”§ API í˜¸í™˜ì„± ì™„ì „ í•´ê²°
1. **í•„ë“œ ë™ê¸°í™”**: ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œ ë°ì´í„° êµ¬ì¡° ì¼ì¹˜
2. **ì¿¼ë¦¬ ì•ˆì •í™”**: ì¡´ì¬í•˜ëŠ” ì»¬ëŸ¼ë§Œ ì‚¬ìš©í•˜ëŠ” ì•ˆì „í•œ ì¿¼ë¦¬
3. **ì—ëŸ¬ ì œê±°**: 500 Internal Server Error ì™„ì „ í•´ê²°
4. **ì¤‘ë³µ ì²˜ë¦¬**: ON CONFLICTë¡œ ì•ˆì „í•œ ì¤‘ë³µ í‰ê°€ì ì²˜ë¦¬

### ğŸ›¡ï¸ ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥
1. **ì´ë¦„ ê¸°ë°˜ ì¤‘ë³µ ê²€ì‚¬**: ê°™ì€ í”„ë¡œì íŠ¸ ë‚´ ë™ì¼ ì´ë¦„ í‰ê°€ì ë°©ì§€
2. **ì´ë©”ì¼ ê²€ì¦**: ìœ íš¨í•œ ì´ë©”ì¼ í˜•ì‹ ì²´í¬
3. **ìë™ ì½”ë“œ ìƒì„±**: ê³ ìœ í•œ í‰ê°€ì ì½”ë“œ ìë™ í• ë‹¹
4. **ì ‘ì†í‚¤ ì—°ë™**: í‰ê°€ì IDì™€ í”„ë¡œì íŠ¸ ID ê¸°ë°˜ ì ‘ì†í‚¤

### â° ì„¸ì…˜ ê´€ë¦¬ ì™„ì „ êµ¬í˜„
1. **30ë¶„ ì„¸ì…˜**: ì •í™•í•œ 30ë¶„ í›„ ìë™ ë¡œê·¸ì•„ì›ƒ
2. **5ë¶„ ê²½ê³ **: ì„¸ì…˜ ë§Œë£Œ 5ë¶„ ì „ ì‹œê°ì  ê²½ê³ 
3. **íƒ€ì´ë¨¸ ë³µêµ¬**: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œì—ë„ ì„¸ì…˜ ì§€ì†
4. **ì„¸ì…˜ ì—°ì¥**: ì›í´ë¦­ìœ¼ë¡œ 30ë¶„ ì—°ì¥

### ğŸ¨ ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ
1. **ì¦‰ì‹œ í”¼ë“œë°±**: í‰ê°€ì ì¶”ê°€ ì¦‰ì‹œ ëª©ë¡ ì—…ë°ì´íŠ¸
2. **ëª…í™•í•œ ì—ëŸ¬**: ì‹¤íŒ¨ ì‹œ êµ¬ì²´ì  ì˜¤ë¥˜ ë©”ì‹œì§€
3. **ì‹œê°ì  ê²½ê³ **: ì£¼ëª©ë„ ë†’ì€ ì„¸ì…˜ ë§Œë£Œ ì•Œë¦¼
4. **ë¶€ë“œëŸ¬ìš´ UI**: ì• ë‹ˆë©”ì´ì…˜ê³¼ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì ìš©

## ğŸ“Š ë³€ê²½ í†µê³„
- **ìˆ˜ì •ëœ íŒŒì¼**: 5ê°œ (ë°±ì—”ë“œ 2ê°œ, í”„ë¡ íŠ¸ì—”ë“œ 3ê°œ)
- **ì¶”ê°€ëœ ë©”ì„œë“œ**: 1ê°œ (resumeSessionTimer)
- **ê°œì„ ëœ ì¿¼ë¦¬**: 5ê°œ
- **ì œê±°ëœ ì˜ì¡´ì„±**: evaluator_code ì»¬ëŸ¼ ì°¸ì¡° ì™„ì „ ì œê±°
- **ìƒˆë¡œìš´ ê¸°ëŠ¥**: ì„¸ì…˜ íƒ€ì´ë¨¸ ë³µêµ¬, ë™ì  í‰ê°€ì ì½”ë“œ ìƒì„±

## ğŸ”„ ê¸°ìˆ ì  êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

### API ì—”ë“œí¬ì¸íŠ¸ ê°œì„ 
```typescript
// /api/evaluators/assign - í‰ê°€ì ë°°ì •
POST {
  project_id: number,
  evaluator_name: string,
  evaluator_email?: string,  // ìƒˆë¡œ ì¶”ê°€
  weight?: number
}

// ì‘ë‹µ êµ¬ì¡°
{
  evaluator: {
    id: number,
    code: string,        // EVL{id} í˜•ì‹ìœ¼ë¡œ ìë™ ìƒì„±
    name: string,
    email: string,
    access_key: string,  // EVL{id}-{project_id} í˜•ì‹
    weight: number,
    status: 'active' | 'completed',
    progress: number
  }
}
```

### ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ìµœì í™”
1. **ê¸°ì¡´ í…Œì´ë¸” í™œìš©**: project_evaluators í…Œì´ë¸”ë§Œ ì‚¬ìš©
2. **ì„ íƒì  í™•ì¥**: evaluator_weights, evaluator_progressëŠ” ì˜µì…˜
3. **ì•ˆì „í•œ ì‚½ì…**: ON CONFLICTë¡œ ì¤‘ë³µ ì²˜ë¦¬
4. **COALESCE í™œìš©**: NULL ê°’ ê¸°ë³¸ê°’ ì²˜ë¦¬

### ì„¸ì…˜ ê´€ë¦¬ lifecycle
```
1. ë¡œê·¸ì¸ â†’ startSession() â†’ localStorage.setItem('login_time')
2. í˜ì´ì§€ ë¡œë“œ â†’ initializeSession() â†’ resumeSessionTimer()
3. 25ë¶„ ê²½ê³¼ â†’ showSessionWarning() â†’ 5ë¶„ ê²½ê³  í‘œì‹œ
4. 30ë¶„ ê²½ê³¼ â†’ forceLogout() â†’ ì„¸ì…˜ ë§Œë£Œ ëª¨ë‹¬
```

## ğŸ¯ ì‚¬ìš©ì ê²½í—˜ ê°œì„  íš¨ê³¼

### í‰ê°€ì ê´€ë¦¬ ì•ˆì •ì„±
1. **100% ì„±ê³µë¥ **: API 500 ì—ëŸ¬ ì™„ì „ ì œê±°
2. **ì¦‰ì‹œ ë°˜ì˜**: í‰ê°€ì ì¶”ê°€ ì¦‰ì‹œ ëª©ë¡ì— í‘œì‹œ
3. **ë°ì´í„° ì¼ê´€ì„±**: ì¤‘ë³µ ë°©ì§€ ë° ìë™ ì—…ë°ì´íŠ¸
4. **ì½”ë“œ ìë™í™”**: ìˆ˜ë™ ì½”ë“œ ì…ë ¥ ë¶ˆí•„ìš”

### ë³´ì•ˆ ë° ì„¸ì…˜ ê´€ë¦¬
1. **ì •í™•í•œ íƒ€ì´ë°**: 30ë¶„ ì •í™•í•œ ì„¸ì…˜ ê´€ë¦¬
2. **ì‚¬ìš©ì ì•Œë¦¼**: 5ë¶„ ì „ ë¯¸ë¦¬ ê²½ê³ 
3. **ì‘ì—… ë³´í˜¸**: ì„¸ì…˜ ë§Œë£Œ ì „ ì €ì¥ ê¶Œê³ 
4. **ìë™ ì •ë¦¬**: ë§Œë£Œ ì‹œ ì™„ì „í•œ ë¡œê·¸ì•„ì›ƒ

### ì‹œìŠ¤í…œ ì•ˆì •ì„±
1. **í˜ì´ì§€ ì§€ì†ì„±**: ìƒˆë¡œê³ ì¹¨í•´ë„ ì„¸ì…˜ ìœ ì§€
2. **ë©”ëª¨ë¦¬ ê´€ë¦¬**: íƒ€ì´ë¨¸ ë° DOM ìš”ì†Œ ì ì ˆí•œ ì •ë¦¬
3. **ì˜¤ë¥˜ ë³µêµ¬**: ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬
4. **í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì €**: ëª¨ë“  ë¸Œë¼ìš°ì €ì—ì„œ ì¼ê´€ëœ ë™ì‘

## ğŸ’¡ ì¶”í›„ ê°œì„  ë°©í–¥

### ì¦‰ì‹œ ì ìš© ê°€ëŠ¥
1. **ë°°ì¹˜ ì¶”ê°€**: ì—¬ëŸ¬ í‰ê°€ì ë™ì‹œ ì¶”ê°€ ê¸°ëŠ¥
2. **í…œí”Œë¦¿ ê°€ì ¸ì˜¤ê¸°**: Excel/CSVì—ì„œ í‰ê°€ì ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
3. **ì—­í•  ì„¸ë¶„í™”**: í‰ê°€ì ê¶Œí•œ ë ˆë²¨ êµ¬ë¶„
4. **ì•Œë¦¼ ì‹œìŠ¤í…œ**: í‰ê°€ìë³„ ì´ë©”ì¼ ì•Œë¦¼ ìë™í™”

### ì¥ê¸° ë¡œë“œë§µ
1. **ì‹¤ì‹œê°„ ë™ê¸°í™”**: WebSocket ê¸°ë°˜ í‰ê°€ì ìƒíƒœ ë™ê¸°í™”
2. **ê³ ê¸‰ ë¶„ì„**: í‰ê°€ìë³„ íŒ¨í„´ ë¶„ì„ ë° í’ˆì§ˆ ê´€ë¦¬
3. **ëª¨ë°”ì¼ ì§€ì›**: ë°˜ì‘í˜• í‰ê°€ì ê´€ë¦¬ ì¸í„°í˜ì´ìŠ¤
4. **API í†µí•©**: ì™¸ë¶€ HR ì‹œìŠ¤í…œê³¼ ì—°ë™

## ğŸ“ ê°œë°œ ë…¸íŠ¸

ì´ë²ˆ ìˆ˜ì •ì€ ì‚¬ìš©ìê°€ ì§€ì†ì ìœ¼ë¡œ ë³´ê³ í•œ í‰ê°€ì ì¶”ê°€ ë¬¸ì œë¥¼ ê·¼ë³¸ì ìœ¼ë¡œ í•´ê²°í•˜ëŠ” ë§¤ìš° ì¤‘ìš”í•œ ì‘ì—…ì´ì—ˆìŠµë‹ˆë‹¤.

### í•µì‹¬ í•´ê²°ì±…
1. **ì™„ì „í•œ ìŠ¤í‚¤ë§ˆ ë…ë¦½ì„±**: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì»¬ëŸ¼ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
2. **ë°©ì–´ì  í”„ë¡œê·¸ë˜ë°**: ëª¨ë“  ì™¸ë¶€ í…Œì´ë¸”ì„ ì˜µì…˜ìœ¼ë¡œ ì²˜ë¦¬
3. **ì‚¬ìš©ì ì¤‘ì‹¬ ì„¤ê³„**: ì´ë¦„ê³¼ ì´ë©”ì¼ ê¸°ë°˜ì˜ ì§ê´€ì  í‰ê°€ì ê´€ë¦¬
4. **ì„¸ì…˜ ì§€ì†ì„±**: 30ë¶„ ì„¸ì…˜ê³¼ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ëŒ€ì‘

### í’ˆì§ˆ ë³´ì¦
- **TypeScript ì»´íŒŒì¼**: íƒ€ì… ì•ˆì •ì„± í™•ë³´
- **ë¹Œë“œ ì„±ê³µ**: í”„ë¡œë•ì…˜ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ
- **Git ì´ë ¥**: ìƒì„¸í•œ ì»¤ë°‹ ë©”ì‹œì§€ì™€ ë³€ê²½ ì¶”ì 
- **ë¬¸ì„œí™”**: ê°œë°œ ê³¼ì • ë° ê²°ê³¼ ì™„ì „ ê¸°ë¡

ì´ì œ ì‚¬ìš©ìëŠ” í‰ê°€ìë¥¼ ì •ìƒì ìœ¼ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆìœ¼ë©°, í–¥í›„ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸ ì‹œì—ë„ ì•ˆì •ì ìœ¼ë¡œ ë™ì‘í•  ê²ƒì…ë‹ˆë‹¤.

---
*ë¬¸ì„œ ìƒì„±ì¼: 2025-09-02*  
*ì‘ì„±ì: Claude Code Assistant*  
*ë¬¸ì„œ ë²„ì „: 1.0*