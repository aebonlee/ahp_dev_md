# 📊 AHP 플랫폼 완전한 데이터베이스 구조 문서
> 작성일: 2025-09-14  
> 버전: 1.0  
> 데이터베이스: PostgreSQL 15.x  
> 호스팅: Render.com  

---

## 🗄️ 데이터베이스 개요

### 기본 정보
- **Database Name**: `ahp_platform_db`
- **Character Set**: `UTF8`
- **Collation**: `en_US.utf8`
- **Time Zone**: `UTC`
- **Schema**: `public`

### 테이블 분류
1. **인증 및 사용자 관리** (2 테이블)
2. **Simple Service - AHP 핵심** (5 테이블)
3. **고급 프로젝트 관리** (3 테이블)
4. **평가 시스템** (4 테이블)
5. **시스템 관리** (3 테이블)

---

## 1. 🔐 인증 및 사용자 관리 테이블

### 1.1 auth_user (Django 기본 사용자 테이블)
**설명**: Django 인증 시스템의 기본 사용자 테이블

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 사용자 고유 ID |
| password | VARCHAR(128) | NOT NULL | 암호화된 비밀번호 |
| last_login | TIMESTAMP WITH TIME ZONE | NULL | 마지막 로그인 시간 |
| is_superuser | BOOLEAN | NOT NULL DEFAULT FALSE | 슈퍼유저 여부 |
| username | VARCHAR(150) | UNIQUE NOT NULL | 사용자명 |
| first_name | VARCHAR(150) | NULL | 이름 |
| last_name | VARCHAR(150) | NULL | 성 |
| email | VARCHAR(254) | NULL | 이메일 주소 |
| is_staff | BOOLEAN | NOT NULL DEFAULT FALSE | 스태프 권한 |
| is_active | BOOLEAN | NOT NULL DEFAULT TRUE | 계정 활성 상태 |
| date_joined | TIMESTAMP WITH TIME ZONE | NOT NULL | 가입일시 |

**인덱스**:
```sql
CREATE INDEX auth_user_username_idx ON auth_user(username);
CREATE INDEX auth_user_email_idx ON auth_user(email);
CREATE INDEX auth_user_date_joined_idx ON auth_user(date_joined DESC);
```

### 1.2 super_admin_customuser (확장 사용자 모델)
**설명**: 사용자 추가 정보 및 구독 관리

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| user_ptr_id | INTEGER | PRIMARY KEY, FK(auth_user.id) | 기본 사용자 참조 |
| user_type | VARCHAR(30) | DEFAULT 'personal_service' | 사용자 타입* |
| subscription_tier | VARCHAR(20) | DEFAULT 'free' | 구독 등급** |
| company_name | VARCHAR(255) | NULL | 회사명 |
| department | VARCHAR(255) | NULL | 부서 |
| position | VARCHAR(100) | NULL | 직책 |
| phone_number | VARCHAR(20) | NULL | 전화번호 |
| address | TEXT | NULL | 주소 |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 생성일시 |
| updated_at | TIMESTAMP WITH TIME ZONE | NULL | 수정일시 |

**사용자 타입 옵션***: 
- `personal_service`: 개인 서비스 사용자
- `evaluator`: 평가자
- `enterprise`: 기업 사용자
- `admin`: 관리자
- `super_admin`: 슈퍼 관리자

**구독 등급 옵션**:
- `free`: 무료
- `basic`: 기본
- `pro`: 프로
- `enterprise`: 엔터프라이즈

---

## 2. 📋 Simple Service 테이블 (AHP 핵심 기능)

### 2.1 simple_projects (프로젝트 마스터)
**설명**: AHP 분석 프로젝트 기본 정보

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 프로젝트 고유 ID |
| title | VARCHAR(200) | NOT NULL | 프로젝트 제목 |
| description | TEXT | NULL | 프로젝트 설명 |
| status | VARCHAR(20) | DEFAULT 'draft' | 프로젝트 상태* |
| created_by_id | INTEGER | FK(auth_user.id) ON DELETE CASCADE | 생성자 |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 생성일시 |
| updated_at | TIMESTAMP WITH TIME ZONE | AUTO UPDATE | 수정일시 |
| is_public | BOOLEAN | DEFAULT FALSE | 공개 여부 |

**상태 옵션***: `draft`(초안), `active`(진행중), `completed`(완료), `archived`(보관)

**인덱스**:
```sql
CREATE INDEX idx_simple_projects_created_by_status ON simple_projects(created_by_id, status);
CREATE INDEX idx_simple_projects_title_status ON simple_projects(title, status);
CREATE INDEX idx_simple_projects_created_at_status ON simple_projects(created_at DESC, status);
```

### 2.2 simple_criteria (평가기준 및 대안)
**설명**: AHP 평가 기준 및 대안 정보

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 기준/대안 고유 ID |
| project_id | INTEGER | FK(simple_projects.id) ON DELETE CASCADE | 프로젝트 참조 |
| name | VARCHAR(200) | NOT NULL | 기준/대안명 |
| description | TEXT | NULL | 설명 |
| type | VARCHAR(20) | DEFAULT 'criteria' | 타입* |
| parent_id | INTEGER | FK(simple_criteria.id) ON DELETE CASCADE | 부모 기준 (계층구조) |
| order_index | INTEGER | DEFAULT 0 | 표시 순서 |
| weight | NUMERIC(10,6) | DEFAULT 0.0 | 가중치 |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 생성일시 |

**타입 옵션***: `criteria`(평가기준), `alternative`(대안)

**제약조건**:
```sql
CONSTRAINT unique_project_name UNIQUE (project_id, name)
CONSTRAINT type_check CHECK (type IN ('criteria', 'alternative'))
```

**인덱스**:
```sql
CREATE INDEX idx_simple_criteria_project_type_order ON simple_criteria(project_id, type, order_index);
CREATE INDEX idx_simple_criteria_parent_order ON simple_criteria(parent_id, order_index);
CREATE INDEX idx_simple_criteria_weight ON simple_criteria(weight);
```

### 2.3 simple_comparisons (쌍대비교 데이터)
**설명**: 기준/대안 간 쌍대비교 값 저장

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 비교 고유 ID |
| project_id | INTEGER | FK(simple_projects.id) ON DELETE CASCADE | 프로젝트 참조 |
| criteria_a_id | INTEGER | FK(simple_criteria.id) ON DELETE CASCADE | 비교 대상 A |
| criteria_b_id | INTEGER | FK(simple_criteria.id) ON DELETE CASCADE | 비교 대상 B |
| value | NUMERIC(10,6) | DEFAULT 1.0 | 비교값 (1/9 ~ 9) |
| created_by_id | INTEGER | FK(auth_user.id) ON DELETE CASCADE | 평가자 |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 생성일시 |

**제약조건**:
```sql
CONSTRAINT value_range CHECK (value >= 0.111111 AND value <= 9.0)
CONSTRAINT unique_comparison UNIQUE (project_id, criteria_a_id, criteria_b_id)
```

**비교값 척도**:
- 1/9 (0.111): 극히 덜 중요
- 1/7 (0.143): 매우 강하게 덜 중요
- 1/5 (0.200): 강하게 덜 중요
- 1/3 (0.333): 약간 덜 중요
- 1: 동등
- 3: 약간 더 중요
- 5: 강하게 더 중요
- 7: 매우 강하게 더 중요
- 9: 극히 더 중요

### 2.4 simple_results (AHP 계산 결과)
**설명**: AHP 알고리즘 계산 결과 저장

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 결과 고유 ID |
| project_id | INTEGER | FK(simple_projects.id) ON DELETE CASCADE | 프로젝트 참조 |
| criteria_id | INTEGER | FK(simple_criteria.id) ON DELETE CASCADE | 기준/대안 참조 |
| weight | NUMERIC(10,6) | NOT NULL | 최종 가중치 |
| rank | INTEGER | NOT NULL | 순위 |
| created_by_id | INTEGER | FK(auth_user.id) ON DELETE CASCADE | 계산 수행자 |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 계산일시 |
| consistency_ratio | NUMERIC(10,6) | NULL | 일관성 비율 (CR) |

**제약조건**:
```sql
CONSTRAINT unique_project_criteria UNIQUE (project_id, criteria_id)
```

**인덱스**:
```sql
CREATE INDEX idx_simple_results_project_rank ON simple_results(project_id, rank);
CREATE INDEX idx_simple_results_weight_rank ON simple_results(weight DESC, rank);
```

### 2.5 simple_data (프로젝트 메타데이터)
**설명**: 프로젝트 관련 추가 데이터 저장 (JSON 형식)

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 데이터 고유 ID |
| project_id | INTEGER | FK(simple_projects.id) ON DELETE CASCADE | 프로젝트 참조 |
| key | VARCHAR(100) | NOT NULL | 데이터 키 |
| value | TEXT | NULL | 데이터 값 (JSON) |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 생성일시 |
| updated_at | TIMESTAMP WITH TIME ZONE | AUTO UPDATE | 수정일시 |

**제약조건**:
```sql
CONSTRAINT unique_project_key UNIQUE (project_id, key)
```

---

## 3. 🎯 고급 프로젝트 관리 테이블

### 3.1 projects_project (고급 프로젝트)
**설명**: 엔터프라이즈급 프로젝트 관리

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 프로젝트 고유 ID |
| title | VARCHAR(255) | NOT NULL | 프로젝트 제목 |
| description | TEXT | NULL | 프로젝트 설명 |
| goal | TEXT | NULL | 프로젝트 목표 |
| status | VARCHAR(20) | DEFAULT 'planning' | 프로젝트 상태* |
| owner_id | INTEGER | FK(auth_user.id) ON DELETE CASCADE | 소유자 |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 생성일시 |
| updated_at | TIMESTAMP WITH TIME ZONE | AUTO UPDATE | 수정일시 |
| deadline | DATE | NULL | 마감일 |
| is_template | BOOLEAN | DEFAULT FALSE | 템플릿 여부 |
| visibility | VARCHAR(20) | DEFAULT 'private' | 공개 범위** |

**상태 옵션***: `planning`, `active`, `review`, `completed`, `archived`  
**공개 범위 옵션**: `private`, `team`, `public`

### 3.2 projects_projectmember (프로젝트 멤버)
**설명**: 프로젝트 참여자 및 권한 관리

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 멤버십 고유 ID |
| project_id | INTEGER | FK(projects_project.id) ON DELETE CASCADE | 프로젝트 참조 |
| user_id | INTEGER | FK(auth_user.id) ON DELETE CASCADE | 사용자 참조 |
| role | VARCHAR(20) | DEFAULT 'viewer' | 역할* |
| joined_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 참여일시 |

**역할 옵션***: `owner`, `admin`, `editor`, `evaluator`, `viewer`

**제약조건**:
```sql
CONSTRAINT unique_project_user UNIQUE (project_id, user_id)
```

### 3.3 projects_criteria (고급 평가기준)
**설명**: 계층적 평가기준 구조

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 기준 고유 ID |
| project_id | INTEGER | FK(projects_project.id) ON DELETE CASCADE | 프로젝트 참조 |
| name | VARCHAR(255) | NOT NULL | 기준명 |
| description | TEXT | NULL | 설명 |
| parent_id | INTEGER | FK(projects_criteria.id) ON DELETE CASCADE | 부모 기준 |
| level | INTEGER | DEFAULT 0 | 계층 레벨 |
| local_weight | NUMERIC(10,6) | DEFAULT 0.0 | 지역 가중치 |
| global_weight | NUMERIC(10,6) | DEFAULT 0.0 | 전역 가중치 |
| order_index | INTEGER | DEFAULT 0 | 표시 순서 |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 생성일시 |

---

## 4. 👥 평가 시스템 테이블

### 4.1 evaluations_evaluation (평가 세션)
**설명**: 평가자별 평가 세션 관리

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 평가 고유 ID |
| project_id | INTEGER | FK(projects_project.id) ON DELETE CASCADE | 프로젝트 참조 |
| evaluator_id | INTEGER | FK(auth_user.id) ON DELETE CASCADE | 평가자 |
| status | VARCHAR(20) | DEFAULT 'pending' | 평가 상태* |
| progress | NUMERIC(5,2) | DEFAULT 0.0 | 진행률 (0-100%) |
| started_at | TIMESTAMP WITH TIME ZONE | NULL | 시작일시 |
| completed_at | TIMESTAMP WITH TIME ZONE | NULL | 완료일시 |
| consistency_ratio | NUMERIC(10,6) | NULL | 일관성 비율 |
| is_consistent | BOOLEAN | DEFAULT TRUE | 일관성 통과 여부 |
| notes | TEXT | NULL | 평가 메모 |

**상태 옵션***: `pending`, `in_progress`, `completed`, `cancelled`

**제약조건**:
```sql
CONSTRAINT progress_range CHECK (progress >= 0 AND progress <= 100)
```

### 4.2 evaluations_pairwisecomparison (개별 쌍대비교)
**설명**: 평가 세션 내 개별 비교 데이터

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 비교 고유 ID |
| evaluation_id | INTEGER | FK(evaluations_evaluation.id) ON DELETE CASCADE | 평가 세션 참조 |
| criteria_a_id | INTEGER | FK(projects_criteria.id) ON DELETE CASCADE | 비교 대상 A |
| criteria_b_id | INTEGER | FK(projects_criteria.id) ON DELETE CASCADE | 비교 대상 B |
| value | NUMERIC(10,6) | DEFAULT 1.0 | 비교값 |
| confidence | NUMERIC(5,2) | DEFAULT 100.0 | 확신도 (0-100%) |
| time_spent | INTEGER | NULL | 소요 시간 (초) |
| created_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 생성일시 |
| updated_at | TIMESTAMP WITH TIME ZONE | AUTO UPDATE | 수정일시 |

### 4.3 evaluations_evaluationinvitation (평가 초대)
**설명**: 평가자 초대 및 응답 관리

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 초대 고유 ID |
| project_id | INTEGER | FK(projects_project.id) ON DELETE CASCADE | 프로젝트 참조 |
| evaluator_id | INTEGER | FK(auth_user.id) NULL | 평가자 (등록 사용자) |
| evaluator_email | VARCHAR(254) | NOT NULL | 평가자 이메일 |
| invited_by_id | INTEGER | FK(auth_user.id) ON DELETE CASCADE | 초대한 사용자 |
| token | VARCHAR(64) | UNIQUE NOT NULL | 초대 토큰 |
| status | VARCHAR(20) | DEFAULT 'pending' | 초대 상태* |
| message | TEXT | NULL | 초대 메시지 |
| sent_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 발송일시 |
| responded_at | TIMESTAMP WITH TIME ZONE | NULL | 응답일시 |
| expires_at | TIMESTAMP WITH TIME ZONE | NULL | 만료일시 |

**상태 옵션***: `pending`, `accepted`, `declined`, `expired`

### 4.4 evaluations_evaluationsession (평가 활동 추적)
**설명**: 평가자 활동 세션 추적

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 세션 고유 ID |
| evaluation_id | INTEGER | FK(evaluations_evaluation.id) ON DELETE CASCADE | 평가 참조 |
| started_at | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 세션 시작 |
| ended_at | TIMESTAMP WITH TIME ZONE | NULL | 세션 종료 |
| ip_address | INET | NULL | IP 주소 |
| user_agent | TEXT | NULL | 브라우저 정보 |
| comparisons_made | INTEGER | DEFAULT 0 | 수행한 비교 수 |

---

## 5. 🔧 시스템 관리 테이블

### 5.1 django_migrations (마이그레이션 이력)
**설명**: Django 데이터베이스 마이그레이션 추적

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 마이그레이션 ID |
| app | VARCHAR(255) | NOT NULL | Django 앱 이름 |
| name | VARCHAR(255) | NOT NULL | 마이그레이션 파일명 |
| applied | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 적용일시 |

### 5.2 django_session (세션 관리)
**설명**: 사용자 세션 데이터 저장

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| session_key | VARCHAR(40) | PRIMARY KEY | 세션 키 |
| session_data | TEXT | NOT NULL | 세션 데이터 (암호화) |
| expire_date | TIMESTAMP WITH TIME ZONE | NOT NULL | 만료일시 |

**인덱스**:
```sql
CREATE INDEX django_session_expire_date_idx ON django_session(expire_date);
```

### 5.3 django_admin_log (관리자 활동 로그)
**설명**: Django Admin 활동 기록

| 필드명 | 데이터 타입 | 제약조건 | 설명 |
|--------|------------|----------|------|
| id | SERIAL | PRIMARY KEY | 로그 ID |
| action_time | TIMESTAMP WITH TIME ZONE | DEFAULT NOW() | 활동 시간 |
| object_id | TEXT | NULL | 대상 객체 ID |
| object_repr | VARCHAR(200) | NULL | 객체 표현 |
| action_flag | SMALLINT | NOT NULL | 액션 플래그* |
| change_message | TEXT | NULL | 변경 메시지 |
| content_type_id | INTEGER | NULL | 콘텐츠 타입 |
| user_id | INTEGER | FK(auth_user.id) ON DELETE CASCADE | 수행자 |

**액션 플래그***: 1(추가), 2(변경), 3(삭제)

---

## 📈 테이블 관계도 (ERD)

### 주요 관계 구조
```
auth_user (사용자)
    ├─1:1─ super_admin_customuser (확장 정보)
    ├─1:N─ simple_projects (생성한 프로젝트)
    ├─1:N─ simple_comparisons (수행한 비교)
    ├─1:N─ simple_results (계산한 결과)
    ├─1:N─ projects_project (소유한 고급 프로젝트)
    ├─1:N─ projects_projectmember (참여 프로젝트)
    ├─1:N─ evaluations_evaluation (평가 세션)
    └─1:N─ evaluations_evaluationinvitation (초대)

simple_projects (Simple 프로젝트)
    ├─1:N─ simple_criteria (평가기준/대안)
    ├─1:N─ simple_comparisons (쌍대비교)
    ├─1:N─ simple_results (계산 결과)
    └─1:N─ simple_data (메타데이터)

simple_criteria (기준/대안)
    ├─1:N─ simple_criteria (하위 기준) [Self-Reference]
    ├─1:N─ simple_comparisons (as criteria_a)
    ├─1:N─ simple_comparisons (as criteria_b)
    └─1:1─ simple_results (계산 결과)

projects_project (고급 프로젝트)
    ├─1:N─ projects_projectmember (멤버)
    ├─1:N─ projects_criteria (평가기준)
    ├─1:N─ evaluations_evaluation (평가 세션)
    └─1:N─ evaluations_evaluationinvitation (초대)

evaluations_evaluation (평가 세션)
    ├─1:N─ evaluations_pairwisecomparison (비교)
    └─1:N─ evaluations_evaluationsession (활동)
```

---

## 🎯 인덱스 전략

### 성능 최적화 인덱스
1. **Primary Key 인덱스**: 모든 `id` 필드 자동 생성
2. **Foreign Key 인덱스**: 모든 FK 필드 자동 생성
3. **복합 인덱스**: 자주 함께 조회되는 필드 조합
4. **필터 인덱스**: WHERE 절에 자주 사용되는 필드
5. **정렬 인덱스**: ORDER BY에 사용되는 필드

### 주요 복합 인덱스
```sql
-- 프로젝트 조회 최적화
CREATE INDEX idx_projects_user_status 
ON simple_projects(created_by_id, status, created_at DESC);

-- 쌍대비교 조회 최적화
CREATE INDEX idx_comparisons_project_user 
ON simple_comparisons(project_id, created_by_id, created_at DESC);

-- 평가 진행 상황 조회
CREATE INDEX idx_evaluation_project_status 
ON evaluations_evaluation(project_id, evaluator_id, status);
```

---

## 📊 데이터 용량 예상

### 테이블별 예상 레코드 수 (1년 기준)
| 테이블명 | 예상 레코드 수 | 평균 레코드 크기 | 예상 용량 |
|---------|--------------|-----------------|-----------|
| auth_user | 10,000 | 500 bytes | 5 MB |
| simple_projects | 50,000 | 1 KB | 50 MB |
| simple_criteria | 500,000 | 500 bytes | 250 MB |
| simple_comparisons | 2,000,000 | 200 bytes | 400 MB |
| simple_results | 500,000 | 200 bytes | 100 MB |
| simple_data | 100,000 | 2 KB | 200 MB |
| **합계** | **3,160,000** | - | **~1 GB** |

### 인덱스 용량
- 예상 인덱스 용량: 데이터의 30-50%
- 총 인덱스 용량: ~500 MB

### 총 예상 용량
- **데이터**: 1 GB
- **인덱스**: 500 MB
- **여유 공간**: 500 MB
- **총합**: ~2 GB

---

## 🔒 보안 및 제약사항

### 데이터 무결성
1. **CASCADE 삭제**: 부모 레코드 삭제 시 자동 삭제
2. **UNIQUE 제약**: 중복 데이터 방지
3. **CHECK 제약**: 데이터 유효성 검증
4. **NOT NULL**: 필수 필드 강제

### 보안 고려사항
1. **비밀번호**: bcrypt 해싱 (Django 기본)
2. **세션**: 암호화된 세션 데이터
3. **CSRF 토큰**: 모든 POST 요청 보호
4. **SQL Injection**: Prepared Statement 사용
5. **권한 관리**: Row-level 보안

---

## 📝 유지보수 가이드

### 백업 정책
```bash
# 일일 백업 (Render.com 자동)
pg_dump ahp_platform_db > backup_$(date +%Y%m%d).sql

# 주간 전체 백업
pg_dumpall > full_backup_$(date +%Y%m%d).sql
```

### 인덱스 관리
```sql
-- 인덱스 사용률 확인
SELECT schemaname, tablename, indexname, idx_scan
FROM pg_stat_user_indexes
ORDER BY idx_scan;

-- 인덱스 재구성
REINDEX TABLE simple_projects;
REINDEX TABLE simple_comparisons;
```

### 성능 모니터링
```sql
-- 느린 쿼리 확인
SELECT query, calls, mean_time, total_time
FROM pg_stat_statements
WHERE mean_time > 100
ORDER BY mean_time DESC;

-- 테이블 크기 확인
SELECT schemaname, tablename, 
       pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;
```

---

## 🚀 마이그레이션 명령

### Django 마이그레이션
```bash
# 마이그레이션 파일 생성
python manage.py makemigrations

# 마이그레이션 적용
python manage.py migrate

# 특정 앱 마이그레이션
python manage.py migrate simple_service

# 마이그레이션 상태 확인
python manage.py showmigrations
```

### 데이터베이스 초기화
```bash
# 데이터베이스 재생성 (주의!)
python manage.py flush

# 초기 데이터 로드
python manage.py loaddata initial_data.json

# 슈퍼유저 생성
python manage.py createsuperuser
```

---

## 📌 참고사항

### 명명 규칙
- **테이블명**: 소문자, 언더스코어 구분
- **필드명**: 소문자, 언더스코어 구분
- **인덱스명**: idx_테이블명_필드명
- **제약조건명**: 타입_테이블명_설명

### 데이터 타입 선택 기준
- **VARCHAR vs TEXT**: 255자 이하는 VARCHAR, 이상은 TEXT
- **NUMERIC vs FLOAT**: 정확도 필요시 NUMERIC
- **TIMESTAMP**: 항상 WITH TIME ZONE 사용
- **BOOLEAN**: 플래그 필드에 사용

### 향후 확장 계획
1. **파티셔닝**: simple_comparisons 테이블 (2M+ 레코드 시)
2. **읽기 전용 복제본**: 분석 쿼리 분산
3. **캐싱 레이어**: Redis 도입 고려
4. **전문 검색**: PostgreSQL Full-Text Search

---

## 📞 문의 및 지원

- **개발자**: Claude + 이애본
- **작성일**: 2025-09-14
- **버전**: 1.0
- **라이선스**: MIT

---

**END OF DOCUMENT**