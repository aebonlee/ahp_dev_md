# ë°±ì—”ë“œ ë°°í¬ ê°€ì´ë“œ - 2025-09-28

## ğŸ¯ ëª©ì 
í”„ë¡œì íŠ¸ API 500 ì˜¤ë¥˜ ìˆ˜ì • ë° í¼ì§€ AHP, íœ´ì§€í†µ ê¸°ëŠ¥ ì§€ì›

## ğŸ“ ë³€ê²½ ì‚¬í•­ ìš”ì•½

### 1. Project ëª¨ë¸ í•„ë“œ ì¶”ê°€
```python
# ìƒˆë¡œ ì¶”ê°€ëœ í•„ë“œ
evaluation_mode = CharField(max_length=20, choices=EVALUATION_MODE_CHOICES, default='practical')
workflow_stage = CharField(max_length=20, choices=WORKFLOW_STAGE_CHOICES, default='creating')
deleted_at = DateTimeField(null=True, blank=True)
criteria_count = PositiveIntegerField(default=0)
alternatives_count = PositiveIntegerField(default=0)
```

### 2. í‰ê°€ ëª¨ë“œ ì„ íƒì§€
- **practical**: ìŒëŒ€ë¹„êµ(ê¶Œì¥) - ê¸°ë³¸ê°’
- **theoretical**: ì´ë¡ ì  ì ‘ê·¼
- **direct_input**: ì§ì ‘ ì…ë ¥
- **fuzzy_ahp**: í¼ì§€ AHP (ì‚¼ê°í¼ì§€ìˆ˜)

### 3. ì›Œí¬í”Œë¡œìš° ë‹¨ê³„
- **creating**: í”„ë¡œì íŠ¸ ìƒì„± ì¤‘
- **waiting**: í‰ê°€ ëŒ€ê¸° ì¤‘
- **evaluating**: í‰ê°€ ì§„í–‰ ì¤‘
- **completed**: ì™„ë£Œ

### 4. íœ´ì§€í†µ ê¸°ëŠ¥ API

#### ì†Œí”„íŠ¸ ì‚­ì œ (íœ´ì§€í†µìœ¼ë¡œ ì´ë™)
```http
DELETE /api/v1/projects/{id}/soft_delete/
Authorization: Bearer {token}
```

#### ë³µì›
```http
POST /api/v1/projects/{id}/restore/
Authorization: Bearer {token}
```

#### íœ´ì§€í†µ ëª©ë¡ ì¡°íšŒ
```http
GET /api/v1/projects/trash/
Authorization: Bearer {token}
```

#### ì˜êµ¬ ì‚­ì œ
```http
DELETE /api/v1/projects/{id}/permanent_delete/
Authorization: Bearer {token}
```

## ğŸš€ Render.com ë°°í¬ ì ˆì°¨

### Step 1: ì½”ë“œ ë°°í¬
Render.comì—ì„œ ìë™ìœ¼ë¡œ ê°ì§€í•˜ê±°ë‚˜ ìˆ˜ë™ ë°°í¬:

1. **Render.com ëŒ€ì‹œë³´ë“œ ì ‘ì†**
   - https://dashboard.render.com
   - ahp-django-backend ì„œë¹„ìŠ¤ ì„ íƒ

2. **GitHub ì—°ë™ í™•ì¸**
   - Settings â†’ Build & Deploy
   - Repository: aebonlee/ahp_app
   - Branch: main
   - Auto-Deploy: Yes

3. **ìˆ˜ë™ ë°°í¬ (í•„ìš”ì‹œ)**
   - Manual Deploy ë²„íŠ¼ í´ë¦­
   - "Deploy latest commit" ì„ íƒ

### Step 2: ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

ë°°í¬ê°€ ì™„ë£Œë˜ë©´ **ë°˜ë“œì‹œ** ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰:

1. **Shell ì ‘ì†**
   ```
   Render Dashboard â†’ ahp-django-backend â†’ Shell íƒ­
   ```

2. **ë§ˆì´ê·¸ë ˆì´ì…˜ ëª…ë ¹ ì‹¤í–‰**
   ```bash
   python manage.py migrate projects
   ```

3. **ê²°ê³¼ í™•ì¸**
   ```
   Expected output:
   Running migrations:
     Applying projects.0003_add_evaluation_mode_and_trash... OK
   ```

### Step 3: ì„œë¹„ìŠ¤ ì¬ì‹œì‘

1. **ìë™ ì¬ì‹œì‘**
   - ë§ˆì´ê·¸ë ˆì´ì…˜ í›„ ìë™ìœ¼ë¡œ ì¬ì‹œì‘ë¨

2. **ìˆ˜ë™ ì¬ì‹œì‘ (í•„ìš”ì‹œ)**
   - Settings â†’ Restart Service

## ğŸ§ª ë°°í¬ í›„ í…ŒìŠ¤íŠ¸

### 1. Health Check
```bash
curl https://ahp-django-backend.onrender.com/api/health
```
ì˜ˆìƒ ì‘ë‹µ:
```json
{"status": "healthy", "service": "AHP Backend API"}
```

### 2. ì‚¬ìš©ì ë¡œê·¸ì¸
```bash
curl -X POST https://ahp-django-backend.onrender.com/api/auth/login/ \
  -H "Content-Type: application/json" \
  -d '{"username":"projecttest3","password":"testpass123"}'
```

í† í° ì €ì¥:
```bash
export TOKEN="ì—¬ê¸°ì—_ë°œê¸‰ë°›ì€_í† í°"
```

### 3. í”„ë¡œì íŠ¸ ìƒì„± í…ŒìŠ¤íŠ¸ (ìŒëŒ€ë¹„êµ)
```bash
curl -X POST https://ahp-django-backend.onrender.com/api/v1/projects/ \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "ìŒëŒ€ë¹„êµ í”„ë¡œì íŠ¸ í…ŒìŠ¤íŠ¸",
    "description": "ì¼ë°˜ AHP í”„ë¡œì íŠ¸",
    "objective": "í…ŒìŠ¤íŠ¸ ëª©ì ",
    "evaluation_mode": "practical",
    "workflow_stage": "creating"
  }'
```

### 4. í¼ì§€ AHP í”„ë¡œì íŠ¸ ìƒì„± í…ŒìŠ¤íŠ¸
```bash
curl -X POST https://ahp-django-backend.onrender.com/api/v1/projects/ \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "í¼ì§€ AHP í”„ë¡œì íŠ¸ í…ŒìŠ¤íŠ¸",
    "description": "ì‚¼ê°í¼ì§€ìˆ˜ë¥¼ ì‚¬ìš©í•œ í”„ë¡œì íŠ¸",
    "objective": "ë¶ˆí™•ì‹¤ì„± ë°˜ì˜ ì˜ì‚¬ê²°ì •",
    "evaluation_mode": "fuzzy_ahp",
    "workflow_stage": "creating"
  }'
```

### 5. í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ
```bash
curl -X GET https://ahp-django-backend.onrender.com/api/v1/projects/ \
  -H "Authorization: Bearer $TOKEN"
```

### 6. íœ´ì§€í†µ í…ŒìŠ¤íŠ¸
```bash
# í”„ë¡œì íŠ¸ ID ì €ì¥
PROJECT_ID="í”„ë¡œì íŠ¸_UUID"

# íœ´ì§€í†µìœ¼ë¡œ ì´ë™
curl -X DELETE "https://ahp-django-backend.onrender.com/api/v1/projects/$PROJECT_ID/soft_delete/" \
  -H "Authorization: Bearer $TOKEN"

# íœ´ì§€í†µ ëª©ë¡ í™•ì¸
curl -X GET https://ahp-django-backend.onrender.com/api/v1/projects/trash/ \
  -H "Authorization: Bearer $TOKEN"

# ë³µì›
curl -X POST "https://ahp-django-backend.onrender.com/api/v1/projects/$PROJECT_ID/restore/" \
  -H "Authorization: Bearer $TOKEN"
```

## âœ… ì„±ê³µ í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Render.com ìë™ ë°°í¬ ì™„ë£Œ
- [ ] ë§ˆì´ê·¸ë ˆì´ì…˜ ì„±ê³µ (0003_add_evaluation_mode_and_trash)
- [ ] Health check ì‘ë‹µ ì •ìƒ
- [ ] ì‚¬ìš©ì ë¡œê·¸ì¸ ì„±ê³µ
- [ ] ì¼ë°˜ í”„ë¡œì íŠ¸ ìƒì„± ì„±ê³µ (practical mode)
- [ ] í¼ì§€ AHP í”„ë¡œì íŠ¸ ìƒì„± ì„±ê³µ (fuzzy_ahp mode)
- [ ] í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ ì„±ê³µ (500 ì˜¤ë¥˜ í•´ê²°)
- [ ] íœ´ì§€í†µ ì´ë™/ë³µì› í…ŒìŠ¤íŠ¸ ì„±ê³µ

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìˆ˜**
   - ë°°í¬ í›„ ë°˜ë“œì‹œ `python manage.py migrate projects` ì‹¤í–‰
   - ì‹¤í–‰í•˜ì§€ ì•Šìœ¼ë©´ í•„ë“œ ëˆ„ë½ ì˜¤ë¥˜ ë°œìƒ

2. **ê¸°ì¡´ ë°ì´í„°**
   - ê¸°ì¡´ í”„ë¡œì íŠ¸ëŠ” ìë™ìœ¼ë¡œ `evaluation_mode='practical'` ì„¤ì •
   - `workflow_stage='creating'` ê¸°ë³¸ê°’ ì ìš©

3. **ê¶Œí•œ í™•ì¸**
   - í”„ë¡œì íŠ¸ ì†Œìœ ìë§Œ ì‚­ì œ/ë³µì›/ì˜êµ¬ì‚­ì œ ê°€ëŠ¥
   - ì‚­ì œëœ í”„ë¡œì íŠ¸ëŠ” ì¼ë°˜ ëª©ë¡ì—ì„œ ìë™ ì œì™¸

4. **í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™**
   - í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œëŠ” ì´ë¯¸ ìƒˆ í•„ë“œ ì§€ì› ì¤€ë¹„ ì™„ë£Œ
   - ë°±ì—”ë“œ ë°°í¬ í›„ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥

## ğŸ“Š ë³€ê²½ íŒŒì¼ ëª©ë¡

```
ahp_django_service_updated/
â”œâ”€â”€ apps/projects/
â”‚   â”œâ”€â”€ models.py                           # í•„ë“œ ì¶”ê°€
â”‚   â”œâ”€â”€ serializers.py                      # ì‹œë¦¬ì–¼ë¼ì´ì € ì—…ë°ì´íŠ¸
â”‚   â”œâ”€â”€ views.py                            # íœ´ì§€í†µ API ì¶”ê°€
â”‚   â””â”€â”€ migrations/
â”‚       â””â”€â”€ 0003_add_evaluation_mode_and_trash.py  # ìƒˆ ë§ˆì´ê·¸ë ˆì´ì…˜
â””â”€â”€ BACKEND_UPDATE_README.md                # ë°°í¬ ê°€ì´ë“œ
```

## ğŸ”— ê´€ë ¨ ë§í¬

- **Render.com ëŒ€ì‹œë³´ë“œ**: https://dashboard.render.com
- **ë°±ì—”ë“œ API**: https://ahp-django-backend.onrender.com
- **GitHub ì €ì¥ì†Œ**: https://github.com/aebonlee/ahp_app
- **ì»¤ë°‹**: c11ffa2f

## ğŸ“ ë¬¸ì œ ë°œìƒ ì‹œ

1. **ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨**
   - Shellì—ì„œ `python manage.py showmigrations projects` í™•ì¸
   - `python manage.py migrate projects --fake-initial` ì‹œë„

2. **500 ì˜¤ë¥˜ ì§€ì†**
   - Logs íƒ­ì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
   - `python manage.py check` ì‹¤í–‰

3. **í•„ë“œ ëˆ„ë½ ì˜¤ë¥˜**
   - ë§ˆì´ê·¸ë ˆì´ì…˜ ì¬ì‹¤í–‰
   - ì„œë¹„ìŠ¤ ìˆ˜ë™ ì¬ì‹œì‘

---
**ì‘ì„±ì¼**: 2025-09-28
**ì‘ì„±ì**: Claude Code
**ë²„ì „**: 1.0.0